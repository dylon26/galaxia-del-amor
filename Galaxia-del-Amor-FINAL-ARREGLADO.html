<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" />
<title>Galaxia Nebulosa - N√∫cleo con TE AMO</title>
<style>
  html, body { margin:0; height:100%; background:#000; overflow:hidden; }
  canvas { display:block; }

  /* --- Reproductor personalizado --- */
  .player {
    position: fixed;
    bottom: 20px;
    left: 50%;
    transform: translateX(-50%);
    width: 90%;
    max-width: 600px;
    display: flex;
    align-items: center;
    gap: 10px;
    padding: 10px;
    border: 2px solid #ff6600;
    border-radius: 999px;
    background: transparent;
    box-shadow: 0 0 15px #ff6600, 0 0 30px #ff3300;
    z-index: 1000;
    font-family: Arial, sans-serif;
    color: #fff;
    font-size: 14px;
  }
  .player button {
    background: transparent;
    border: none;
    color: #fff;
    font-size: 22px;
    cursor: pointer;
    filter: drop-shadow(0 0 6px #ff6600);
    transition: transform 0.2s;
  }
  .player button:hover { transform: scale(1.2); filter: drop-shadow(0 0 10px #ff3300); }

  .progress {
    flex-grow: 1;
    height: 14px;
    background: rgba(255,255,255,0.12);
    border-radius: 999px;
    overflow: hidden;
    cursor: pointer;
    position: relative;
  }
  .progress-bar {
    height: 100%;
    width: 0%;
    background: linear-gradient(270deg, #ff6600, #ff3300, #ff0099, #ff6600);
    background-size: 400% 400%;
    border-radius: 999px;
    box-shadow: 0 0 10px #ff6600;
    animation: flowing 6s ease infinite;
  }
  @keyframes flowing {
    0% { background-position: 0% 50%; }
    50% { background-position: 100% 50%; }
    100% { background-position: 0% 50%; }
  }
  .time {
    min-width: 74px;
    text-align: right;
    font-size: 12px;
    color: #fff;
    text-shadow: 0 0 5px #ff6600;
  }
</style>
</head>
<body>
<canvas id="c"></canvas>

<!-- Reproductor personalizado -->
<div class="player">
  <button id="play">‚ñ∂Ô∏è</button>
  <div class="progress" id="progress"><div class="progress-bar" id="progress-bar"></div></div>
  <div class="time" id="time">0:00 / 0:00</div>
</div>

<audio id="audio">
  <source src="AUD-20260104-WA0001.mp3.mp3" type="audio/mpeg">
</audio>


<script src="https://cdn.jsdelivr.net/npm/three@0.148.0/build/three.min.js"></script>
<script>
// ================= Reproductor =================
const audio=document.getElementById('audio'),playBtn=document.getElementById('play'),progress=document.getElementById('progress'),progressBar=document.getElementById('progress-bar'),timeDisplay=document.getElementById('time');let isPlaying=false;
playBtn.addEventListener('click',async()=>{if(isPlaying){audio.pause();playBtn.textContent='‚ñ∂Ô∏è';}else{await audio.play();playBtn.textContent='‚è∏Ô∏è';}isPlaying=!isPlaying;});
function formatTime(sec){if(!isFinite(sec))return'0:00';const m=Math.floor(sec/60);const s=Math.floor(sec%60).toString().padStart(2,'0');return m+':'+s;}
audio.addEventListener('timeupdate',()=>{const percent=(audio.currentTime/audio.duration)*100;progressBar.style.width=(isFinite(percent)?percent:0)+'%';timeDisplay.textContent=formatTime(audio.currentTime)+' / '+formatTime(audio.duration);});
progress.addEventListener('click',(e)=>{const rect=progress.getBoundingClientRect();const x=e.clientX-rect.left;const percent=x/rect.width;if(isFinite(audio.duration))audio.currentTime=percent*audio.duration;});

// ================= Escena =================
const canvas=document.getElementById('c');
const renderer=new THREE.WebGLRenderer({canvas,antialias:true});
renderer.setPixelRatio(Math.min(window.devicePixelRatio||1,2));
renderer.setSize(innerWidth,innerHeight);
const scene=new THREE.Scene();
const camera=new THREE.PerspectiveCamera(60,innerWidth/innerHeight,0.1,5000);
let targetDist=300,currentDist=300,rotX=0.2,rotY=0;

// Fondo
const loader=new THREE.TextureLoader();
const nebulaTex=loader.load('https://raw.githubusercontent.com/mrdoob/three.js/dev/examples/textures/cube/space/px.jpg');
scene.background=nebulaTex;

// Estrellas
(function makeStars(count=2000,spread=3000){
  const g=new THREE.BufferGeometry();
  const pos=new Float32Array(count*3);
  for(let i=0;i<count;i++){
    const r=spread*(0.3+Math.random()*0.7);
    const th=Math.random()*Math.PI*2;
    const ph=Math.acos(2*Math.random()-1);
    pos[i*3+0]=r*Math.sin(ph)*Math.cos(th);
    pos[i*3+1]=r*Math.cos(ph);
    pos[i*3+2]=r*Math.sin(ph)*Math.sin(th);
  }
  g.setAttribute('position',new THREE.BufferAttribute(pos,3));
  scene.add(new THREE.Points(g,new THREE.PointsMaterial({size:1.5,color:0xffffff,depthWrite:false})));
})();

// N√∫cleo transl√∫cido con efecto de latido
const coreMat=new THREE.MeshPhongMaterial({color:0x111111,transparent:true,opacity:0.6,shininess:200});
const core=new THREE.Mesh(new THREE.SphereGeometry(40,64,64),coreMat);
scene.add(core);

// Mensaje "TE AMO ‚ù§Ô∏è" fijo en el centro
function makeCenterTextTexture(msg){
  const c=document.createElement('canvas');c.width=512;c.height=512;
  const ctx=c.getContext('2d');
  ctx.clearRect(0,0,c.width,c.height);
  ctx.font='bold 80px Arial';
  ctx.textAlign='center';
  ctx.textBaseline='middle';
  ctx.fillStyle='#ff0033';
  ctx.shadowColor='#ff66aa';
  ctx.shadowBlur=50;
  ctx.fillText(msg,c.width/2,c.height/2);
  return new THREE.CanvasTexture(c);
}
const centerTex=makeCenterTextTexture("TE AMO ‚ù§Ô∏è");
const centerMat=new THREE.SpriteMaterial({map:centerTex,transparent:true});
const centerSprite=new THREE.Sprite(centerMat);
centerSprite.scale.set(60,60,1);
centerSprite.position.set(0,0,0);
centerSprite.renderOrder=999;
scene.add(centerSprite);

// Glow exterior
function makeGlow(size=768,c1='255,160,0',c2='255,60,0'){
  const c=document.createElement('canvas');c.width=c.height=size;
  const g=c.getContext('2d');
  const grad=g.createRadialGradient(size/2,size/2,size*0.05,size/2,size/2,size*0.5);
  grad.addColorStop(0,'rgba('+c1+',0.9)');
  grad.addColorStop(0.5,'rgba('+c2+',0.5)');
  grad.addColorStop(1,'rgba(0,0,0,0)');
  g.fillStyle=grad;g.fillRect(0,0,size,size);
  return new THREE.CanvasTexture(c);
}
const glow=new THREE.Sprite(new THREE.SpriteMaterial({map:makeGlow(),transparent:true,depthWrite:false}));
glow.scale.set(500,500,1);
scene.add(glow);

// Anillos
function ringTexture(size=768){
  const c=document.createElement('canvas');c.width=c.height=size;
  const g=c.getContext('2d');g.translate(size/2,size/2);
  const r1=size*0.34, r2=size*0.49;
  const grd=g.createRadialGradient(0,0,r1*0.3,0,0,r2);
  grd.addColorStop(0.0,'rgba(255,255,200,1)');
  grd.addColorStop(0.3,'rgba(255,160,60,0.9)');
  grd.addColorStop(0.65,'rgba(255,80,0,0.6)');
  grd.addColorStop(1.0,'rgba(0,0,0,0)');
  g.fillStyle=grd;
  g.beginPath(); g.arc(0,0,r2,0,Math.PI*2); g.arc(0,0,r1,0,Math.PI*2,true); g.closePath(); g.fill();
  return new THREE.CanvasTexture(c);
}
const ring1=new THREE.Mesh(new THREE.RingGeometry(60,80,128),new THREE.MeshBasicMaterial({map:ringTexture(),transparent:true,side:THREE.DoubleSide}));
const ring2=new THREE.Mesh(new THREE.RingGeometry(85,100,128),new THREE.MeshBasicMaterial({map:ringTexture(),transparent:true,side:THREE.DoubleSide,opacity:0.6}));
ring1.rotation.x=ring2.rotation.x=Math.PI/2;
scene.add(ring1);scene.add(ring2);

// Palabras alrededor
const WORDS=[];
const baseWords=[
  'üíñ Mi amor','üåû Mi sol','üåé Mi mundo','‚ú® Brillas','‚ù§Ô∏è Te amo','üåå Universo',
  'üëë Reina','üå† Estrella','üí´ Mi cielo','üî• Siempre t√∫','üé∂ Tu risa','ü¶ã Libertad',
  'üíé Eres todo','üôè Gracias','üíï Cari√±o','üåπ Amor eterno','ü§ó Abrazos','üå∏ Esperanza',
  'üåà Alegr√≠a','üåü Contigo','üß∏ Ternura','üéÅ Mi raz√≥n','üåô Mi destino','üíå Recuerdos',
  'üïäÔ∏è Mi paz','ü™ê Mi universo','üåä Mi calma','üí° Mi luz','üçí Dulzura','ü•∞ Mi vida',
  'üéá Felicidad','üåª Alegr√≠a','üå∫ Mi flor','üíú Eternidad','üåü Sue√±os','‚ú® Magia',
  'üéµ Canci√≥n','üî• Pasi√≥n','‚≠ê Mi estrella','üå¥ Mi para√≠so','üåÑ Amanecer','üåÉ Noche contigo',
  'üéâ Mi fiesta','üí´ Inspiraci√≥n','üå∑ Siempre juntos','üéÄ Mi ternura','üçÄ Mi fortuna','ü™û Mi reflejo'
];
for(let i=0;i<6;i++){WORDS.push(...baseWords);}
function makeTextTexture(text,color){
  const c=document.createElement('canvas');c.width=512;c.height=128;
  const ctx=c.getContext('2d');ctx.clearRect(0,0,c.width,c.height);
  ctx.font='bold 60px Arial';ctx.textAlign='center';ctx.textBaseline='middle';
  ctx.fillStyle='#fff';ctx.shadowColor=color;ctx.shadowBlur=30;
  ctx.fillText(text,c.width/2,c.height/2);
  return new THREE.CanvasTexture(c);
}
const COLORS=['#ff66ff','#66ccff','#ffd36b','#ff9966','#8df59a','#ffa0f8','#c6a7ff','#ff4444','#44ff99','#99ccff'];
const textGroup=new THREE.Group();scene.add(textGroup);
for(let i=0;i<WORDS.length;i++){
  const tex=makeTextTexture(WORDS[i],COLORS[i%COLORS.length]);
  const mat=new THREE.SpriteMaterial({map:tex,transparent:true});
  const sp=new THREE.Sprite(mat);
  sp.scale.set(50,16,1);
  const phi=Math.acos(2*Math.random()-1);const theta=Math.random()*Math.PI*2;
  const r=150+Math.random()*120;
  sp.position.set(r*Math.sin(phi)*Math.cos(theta),r*Math.cos(phi),r*Math.sin(phi)*Math.sin(theta));
  sp.userData={phi:phi,theta:theta,radius:r,speed:0.001+Math.random()*0.001};
  textGroup.add(sp);
}

// Controles c√°mara
let dragging=false,lastX=0,lastY=0;
function onDown(e){dragging=true;const t=e.touches?e.touches[0]:e;lastX=t.clientX;lastY=t.clientY;}
function onMove(e){if(!dragging)return;const t=e.touches?e.touches[0]:e;const dx=(t.clientX-lastX)/innerWidth;const dy=(t.clientY-lastY)/innerHeight;rotY-=dx*3;rotX=Math.max(-1.2,Math.min(1.2,rotX-dy*2.2));lastX=t.clientX;lastY=t.clientY;}
function onUp(){dragging=false;}
addEventListener('mousedown',onDown);addEventListener('mousemove',onMove);addEventListener('mouseup',onUp);
addEventListener('touchstart',onDown,{passive:true});addEventListener('touchmove',onMove,{passive:true});addEventListener('touchend',onUp,{passive:true});
addEventListener('wheel',(e)=>{targetDist+=e.deltaY*0.25;targetDist=Math.max(160,Math.min(600,targetDist));},{passive:true});

// Zoom con pellizco en m√≥viles
let pinch=0;
addEventListener('touchmove',(e)=>{
  if(e.touches && e.touches.length===2){
    e.preventDefault();
    const dx=e.touches[0].clientX-e.touches[1].clientX;
    const dy=e.touches[0].clientY-e.touches[1].clientY;
    const d=Math.hypot(dx,dy);
    if(pinch){targetDist+=(pinch-d)*0.5;targetDist=Math.max(160,Math.min(600,targetDist));}
    pinch=d;
  }
},{passive:false});
addEventListener('touchend',()=>{pinch=0;},{passive:true});

// Animaci√≥n
let t=0;
function tick(){requestAnimationFrame(tick);t+=0.01;
  ring1.rotation.z+=0.002;ring2.rotation.z-=0.0015;
  glow.scale.set(500*(1+Math.sin(t*0.4)*0.03),500*(1+Math.sin(t*0.4)*0.03),1);
  const s=1.0+0.05*Math.sin(t*3); // latido
  core.scale.set(s,s,s);
  textGroup.children.forEach(sp=>{
    sp.material.opacity=0.8+0.2*Math.sin(t*2);
    sp.userData.theta+=sp.userData.speed;
    sp.position.x=sp.userData.radius*Math.sin(sp.userData.phi)*Math.cos(sp.userData.theta);
    sp.position.z=sp.userData.radius*Math.sin(sp.userData.phi)*Math.sin(sp.userData.theta);
  });
  currentDist+=(targetDist-currentDist)*0.06;
  const cx=Math.cos(rotX),sx=Math.sin(rotX);const cy=Math.cos(rotY),sy=Math.sin(rotY);
  camera.position.set(currentDist*sy*cx,currentDist*sx,currentDist*cy*cx);camera.lookAt(0,0,0);
  renderer.render(scene,camera);
}
tick();
</script>

<div id="dedicatoria" style="
position: fixed;
top: 50%;
left: 50%;
transform: translate(-50%, -50%);
color: #ff99cc;
font-family: Arial, sans-serif;
font-size: 26px;
text-align: center;
text-shadow: 0 0 15px #ff3366;
display: none;
z-index: 2000;
">
Brindo por la hermosa dama que yo m√°s quiero que me acompa√±a,<br>
de cuyo amor soy prisionero.<br><br>
<strong>Te amo mi mujercita</strong><br><br>
Firmado: <strong>Dylan, tu hombre üíû</strong>
</div>

</body>

<script>
const audio = document.getElementById("audio");
const dedicatoria = document.getElementById("dedicatoria");

audio.addEventListener("ended", () => {
  dedicatoria.style.display = "block";
});
</script>

</html>